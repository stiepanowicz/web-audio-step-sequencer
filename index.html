<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Audio Step Sequencer</title>
</head>
<body>
    <label for="attack">Attack</label>
    <input  name="attack"
            id="attack"
            type="range"
            min="0"
            max="1"
            value="0.2"
            step="0.1" />
    
    <label for="release">Release</label>
    <input  name="release"
            id="release"
            type="range"
            min="0"
            max="1"
            value="0.5"
            step="0.1" />

    <script>
        const audioContext = new AudioContext();

        // Periodic wave
        const wave = new PeriodicWave(AudioContext, {
            real: wavetable.real,
            imag: wavetable.imag,
        });


        // The Oscillator
        function playSweep(time) {
            const osc = new OscillatorNode(AudioContext, {
                frequency: 380,
                type: "custom",
                periodicWave: wave,
            });

            const sweepEnv = new GainNode(audioContext);
            sweepEnv.gain.cancelScheduledValues(time);
            sweepEnv.gain.setValueAtTime(0, time);
            sweepEnv.gain.linearRampToValueAtTime(1, time + attackTime);
            sweepEnv.gain.linearRampToValueAtTime(0, time + sweepLength - releaseTime);

            osc.connect(audioContext.destination);
            ost.start(time);
            osc.stop(time + 1);
        }

        // The second Oscillator
        const osc = new OscillatorNode(audioContext, {
            type: "sine",
            frequency: pulseHz,
        });

        const amp = new GainNode(audioContext, {
            value: 1,
        });

        // LFO Oscillator
        const lfo = new OscillatorNode(audioContext, {
            type: 'square',
            frequency: 30,
        });



        // Amplitude Control
        let attackTime = 0.2;
        const attackControl = document.querySelector("#attack");
        attackControl.addEventListener(
            "input",
            (ev) => {
                attackTime = parseInt(ev.target.value, 10);
            },
            false,
        );

        let releaseTime = 0.5;
        const releaseControl = document.querySelector("#release");
        releaseControl.addEventListener(
        "input",
        (ev) => {
            releaseTime = parseInt(ev.target.value, 10);
        },
        false,
        );
        
        // connecting the graph
        lfo.connect(amp.gain);
        osc.connect(amp).connect(audioContext.destination);
        lfo.start();
        osc.start(time);
        osc.stop(time + pulseTime);
    </script>
</body>
</html>
